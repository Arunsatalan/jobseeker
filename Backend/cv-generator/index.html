<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professional CV Generator</title>
    <style>
        * { margin:0; padding:0; box-sizing:border-box; }
        body { font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif; background:linear-gradient(135deg,#667eea 0%,#764ba2 100%); min-height:100vh; padding:20px; }
        .container { max-width:1000px; margin:0 auto; background:white; border-radius:12px; box-shadow:0 20px 60px rgba(0,0,0,0.3); padding:40px; }
        .header { text-align:center; margin-bottom:40px; border-bottom:3px solid #667eea; padding-bottom:20px; }
        h1 { color:#333; font-size:32px; margin-bottom:10px; }
        .subtitle { color:#666; font-size:16px; }
        .form-section { margin-bottom:35px; padding:25px; background:#f9f9f9; border-left:5px solid #667eea; border-radius:8px; }
        .section-title { font-size:20px; font-weight:700; color:#667eea; margin-bottom:20px; }
        .form-row { display:grid; grid-template-columns:1fr 1fr; gap:20px; margin-bottom:15px; }
        .form-row.full { grid-template-columns:1fr; }
        .form-group { display:flex; flex-direction:column; }
        label { font-weight:600; color:#333; margin-bottom:6px; font-size:13px; }
        input,textarea { padding:12px; border:2px solid #e0e0e0; border-radius:6px; font-family:inherit; font-size:14px; transition:all 0.3s; }
        input:focus,textarea:focus { outline:0; border-color:#667eea; box-shadow:0 0 0 4px rgba(102,126,234,0.1); }
        textarea { resize:vertical; min-height:80px; }
        .add-btn { background:#667eea; color:white; border:0; padding:10px 16px; border-radius:6px; cursor:pointer; font-size:13px; font-weight:600; margin-top:10px; }
        .add-btn:hover { background:#5568d3; }
        .remove-btn { background:#ff6b6b; color:white; border:0; padding:10px 16px; border-radius:6px; cursor:pointer; font-size:13px; font-weight:600; margin-top:10px; }
        .remove-btn:hover { background:#ee5a5a; }
        .item-card { background:white; padding:18px; border-radius:8px; margin-bottom:15px; border:2px solid #e0e0e0; }
        .skill-tag { display:inline-block; background:#667eea; color:white; padding:8px 14px; border-radius:20px; font-size:13px; margin-right:8px; margin-bottom:8px; font-weight:500; }
        .skill-tag .remove { margin-left:8px; cursor:pointer; }
        .button-group { display:flex; gap:12px; margin-top:40px; }
        .submit-btn { flex:1; background:linear-gradient(135deg,#667eea 0%,#764ba2 100%); color:white; border:0; padding:14px; border-radius:8px; font-size:16px; font-weight:600; cursor:pointer; }
        .submit-btn:hover:not(:disabled) { transform:translateY(-2px); box-shadow:0 10px 30px rgba(102,126,234,0.3); }
        .submit-btn:disabled { opacity:0.6; }
        .reset-btn { background:#6c757d; color:white; border:0; padding:14px 30px; border-radius:8px; cursor:pointer; }
        .message { padding:16px; border-radius:8px; margin-bottom:20px; display:none; }
        .message.success { background:#d4edda; color:#155724; }
        .message.error { background:#f8d7da; color:#721c24; }
        .message.loading { background:#d1ecf1; color:#0c5460; }
        .bullet-input { display:flex; gap:10px; margin-bottom:10px; }
        .bullet-input input { flex:1; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1> Professional CV Generator</h1>
            <p class="subtitle">Create a stunning, ATS-friendly resume</p>
        </div>
        <div id="message" class="message"></div>
        <form id="cvForm">
            <div class="form-section">
                <div class="section-title"> Personal Information</div>
                <div class="form-row">
                    <div class="form-group"><label>Full Name *</label><input type="text" id="fullName" required></div>
                    <div class="form-group"><label>Professional Title *</label><input type="text" id="jobTitle" placeholder="e.g., Senior Data Engineer" required></div>
                </div>
                <div class="form-row">
                    <div class="form-group"><label>Email *</label><input type="email" id="email" required></div>
                    <div class="form-group"><label>Phone</label><input type="tel" id="phone"></div>
                </div>
                <div class="form-row full"><div class="form-group"><label>Location</label><input type="text" id="location" placeholder="City, Country"></div></div>
                <div class="form-row full"><div class="form-group"><label>Professional Summary *</label><textarea id="summary" placeholder="Brief overview..." required></textarea></div></div>
            </div>
            <div class="form-section">
                <div class="section-title"> Professional Experience</div>
                <div id="experienceContainer"></div>
                <button type="button" class="add-btn" onclick="addExperience()">+ Add Experience</button>
            </div>
            <div class="form-section">
                <div class="section-title"> Education</div>
                <div id="educationContainer"></div>
                <button type="button" class="add-btn" onclick="addEducation()">+ Add Education</button>
            </div>
            <div class="form-section">
                <div class="section-title"> Technical Skills</div>
                <div class="form-row">
                    <div class="form-group"><label>Programming Languages</label><input type="text" id="techLanguages" placeholder="Python, Java, SQL"></div>
                    <div class="form-group"><label>Frameworks</label><input type="text" id="techFrameworks" placeholder="React, Django"></div>
                </div>
                <div class="form-row">
                    <div class="form-group"><label>Databases</label><input type="text" id="techDatabases" placeholder="PostgreSQL, MongoDB"></div>
                    <div class="form-group"><label>Cloud & Tools</label><input type="text" id="techCloud" placeholder="AWS, Docker"></div>
                </div>
                <div class="form-row full"><div class="form-group"><label>Other Tools</label><input type="text" id="techTools" placeholder="Git, Jenkins"></div></div>
            </div>
            <div class="form-section">
                <div class="section-title"> Core Competencies</div>
                <div style="display:flex;gap:10px;margin-bottom:15px">
                    <input type="text" id="skillInput" placeholder="e.g., Data Pipeline Design" style="flex:1">
                    <button type="button" class="add-btn" onclick="addSkill()">Add Skill</button>
                </div>
                <div id="skillsContainer"></div>
            </div>
            <div class="form-section">
                <div class="section-title"> Certifications</div>
                <div id="certificationsContainer"></div>
                <button type="button" class="add-btn" onclick="addCertification()">+ Add Certification</button>
            </div>
            <div class="form-section">
                <div class="section-title"> Key Projects</div>
                <div id="projectsContainer"></div>
                <button type="button" class="add-btn" onclick="addProject()">+ Add Project</button>
            </div>
            <div class="button-group">
                <button type="submit" class="submit-btn"> Generate & Download CV</button>
                <button type="reset" class="reset-btn">Clear</button>
            </div>
        </form>
    </div>
    <script>
        let experience=[], education=[], skills=[], certifications=[], projects=[];
        function renderExperience() { document.getElementById("experienceContainer").innerHTML=experience.map((e,i)=>"<div class='item-card'><div class='form-row'><div class='form-group'><label>Job Title</label><input type='text' value='"+e.title+"' onchange='experience["+i+"].title=this.value'></div><div class='form-group'><label>Company</label><input type='text' value='"+e.company+"' onchange='experience["+i+"].company=this.value'></div></div><div class='form-row'><div class='form-group'><label>Location</label><input type='text' value='"+e.location+"' onchange='experience["+i+"].location=this.value'></div><div class='form-group'><label>Duration</label><div style='display:flex;gap:8px'><input type='text' value='"+e.start+"' onchange='experience["+i+"].start=this.value' placeholder='Start' style='flex:1'><span style='align-self:center'></span><input type='text' value='"+e.end+"' onchange='experience["+i+"].end=this.value' placeholder='End' style='flex:1'></div></div></div><div class='form-group'><label>Achievements</label>"+e.bullets.map((b,j)=>"<div class='bullet-input'><span style='align-self:center'></span><input type='text' value='"+b+"' onchange='experience["+i+"].bullets["+j+"]=this.value'></div>").join("")+"</div><button type='button' class='remove-btn' onclick='removeExperience("+e.id+")'>Remove</button></div>").join(""); }
        function renderEducation() { document.getElementById("educationContainer").innerHTML=education.map((e,i)=>"<div class='item-card'><div class='form-row'><div class='form-group'><label>Degree</label><input type='text' value='"+e.degree+"' onchange='education["+i+"].degree=this.value'></div><div class='form-group'><label>Field</label><input type='text' value='"+e.field+"' onchange='education["+i+"].field=this.value'></div></div><div class='form-row'><div class='form-group'><label>Institution</label><input type='text' value='"+e.institution+"' onchange='education["+i+"].institution=this.value'></div><div class='form-group'><label>Location</label><input type='text' value='"+e.location+"' onchange='education["+i+"].location=this.value'></div></div><div class='form-row'><div class='form-group'><label>Graduation Year</label><input type='text' value='"+e.end+"' onchange='education["+i+"].end=this.value'></div><div class='form-group'><label>GPA</label><input type='text' value='"+e.gpa+"' onchange='education["+i+"].gpa=this.value' placeholder='3.8/4.0'></div></div><button type='button' class='remove-btn' onclick='removeEducation("+e.id+")'>Remove</button></div>").join(""); }
        function renderCertifications() { document.getElementById("certificationsContainer").innerHTML=certifications.map((c,i)=>"<div class='item-card'><div class='form-row'><div class='form-group'><label>Certification Name</label><input type='text' value='"+c.name+"' onchange='certifications["+i+"].name=this.value'></div><div class='form-group'><label>Issuer</label><input type='text' value='"+c.issuer+"' onchange='certifications["+i+"].issuer=this.value'></div></div><div class='form-row'><div class='form-group'><label>Date</label><input type='text' value='"+c.date+"' onchange='certifications["+i+"].date=this.value' placeholder='Mar 2023'></div></div><button type='button' class='remove-btn' onclick='removeCertification("+c.id+")'>Remove</button></div>").join(""); }
        function renderProjects() { document.getElementById("projectsContainer").innerHTML=projects.map((p,i)=>"<div class='item-card'><div class='form-row full'><div class='form-group'><label>Project Name</label><input type='text' value='"+p.name+"' onchange='projects["+i+"].name=this.value'></div></div><div class='form-row full'><div class='form-group'><label>Technologies</label><input type='text' value='"+p.technologies+"' onchange='projects["+i+"].technologies=this.value'></div></div><div class='form-row full'><div class='form-group'><label>Description</label><textarea onchange='projects["+i+"].description=this.value'>"+p.description+"</textarea></div></div><button type='button' class='remove-btn' onclick='removeProject("+p.id+")'>Remove</button></div>").join(""); }
        function renderSkills() { document.getElementById("skillsContainer").innerHTML=skills.map(s=>"<span class='skill-tag'>"+s+"<span class='remove' style='cursor:pointer' onclick=\"removeSkill('"+s.replace(/'/g,"\\'")+"')\">×</span></span>").join(""); }
        function addExperience() { const id=Date.now(); experience.push({id,title:"",company:"",location:"",start:"",end:"",bullets:["","",""]}); renderExperience(); }
        function removeExperience(id) { experience=experience.filter(e=>e.id!==id); renderExperience(); }
        function addEducation() { const id=Date.now(); education.push({id,degree:"",field:"",institution:"",location:"",start:"",end:"",gpa:""}); renderEducation(); }
        function removeEducation(id) { education=education.filter(e=>e.id!==id); renderEducation(); }
        function addCertification() { const id=Date.now(); certifications.push({id,name:"",issuer:"",date:""}); renderCertifications(); }
        function removeCertification(id) { certifications=certifications.filter(c=>c.id!==id); renderCertifications(); }
        function addProject() { const id=Date.now(); projects.push({id,name:"",technologies:"",description:""}); renderProjects(); }
        function removeProject(id) { projects=projects.filter(p=>p.id!==id); renderProjects(); }
        function addSkill() { const input=document.getElementById("skillInput"); if(input.value.trim()){ skills.push(input.value.trim()); input.value=""; renderSkills(); } }
        function removeSkill(s) { skills=skills.filter(x=>x!==s); renderSkills(); }
        document.getElementById("skillInput").addEventListener("keypress",e=>{if(e.key==="Enter"){e.preventDefault();addSkill();}});
        window.addEventListener("load",()=>{ addExperience(); addEducation(); });
        function showMessage(msg,type="success"){ const el=document.getElementById("message"); el.textContent=msg; el.className="message "+type; setTimeout(()=>el.className="message",5000); }
        document.getElementById("cvForm").addEventListener("submit",async(e)=>{
            e.preventDefault();
            const data={
                fullName:document.getElementById("fullName").value,
                jobTitle:document.getElementById("jobTitle").value,
                email:document.getElementById("email").value,
                phone:document.getElementById("phone").value,
                location:document.getElementById("location").value,
                summary:document.getElementById("summary").value,
                skills:skills,
                experience:experience.filter(x=>x.title||x.company),
                education:education.filter(x=>x.degree||x.institution),
                technicalSkills:{
                    languages:document.getElementById("techLanguages").value,
                    frameworks:document.getElementById("techFrameworks").value,
                    databases:document.getElementById("techDatabases").value,
                    cloud:document.getElementById("techCloud").value,
                    tools:document.getElementById("techTools").value
                },
                certifications:certifications.filter(x=>x.name||x.issuer),
                projects:projects.filter(x=>x.name||x.description)
            };
            if(!data.fullName||!data.email||!data.jobTitle||!data.summary){showMessage("Fill in all required fields","error");return;}
            if(data.experience.length===0||data.education.length===0||data.skills.length===0){showMessage("Add: experience, education, and skills","error");return;}
            const btn=document.querySelector(".submit-btn");
            btn.disabled=true;
            btn.textContent="Generating...";
            showMessage("Generating CV...","loading");
            try{
                const res=await fetch("http://localhost:4000/generate-cv",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(data)});
                if(!res.ok)throw new Error("Generation failed");
                const blob=await res.blob(),url=URL.createObjectURL(blob),a=document.createElement("a");
                a.href=url;
                a.download=data.fullName.replace(/\s+/g,"_")+"_Professional_CV.pdf";
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                showMessage(" CV generated successfully!","success");
            }catch(err){
                showMessage("Error: "+err.message,"error");
            }finally{
                btn.disabled=false;
                btn.textContent=" Generate & Download CV";
            }
        });
    </script>
</body>
</html>
